---
title: webpack 常用功能3
tags:
  - webpack
  - 自动化
  - 前端
categories:
  - 自动化
  - webpack
folder: Webpack
abbrlink: db8159cb
date: 2017-12-15 23:34:24
photo: /xmind/webpack/webpack-常用功能03.png
---

继续对 webpack 基础使用进行学习

<!-- more -->

{% img /xmind/webpack/webpack-常用功能03.detail.png %}

# webpack

基于 webpack 3.* 的学习

******

## 基本部署

```shell tree
	.
	├── dist
	│   ├── bundle.js
	│   ├── css
	│   │   └── style.css
	│   ├── img
	│   │   └── c841c1357ae08329349b22bdd3dbc886.png
	│   └── index.html
	├── entry.js
	├── package.json
	├── src
	│   ├── css
	│   │   └── style.css
	│   ├── img
	│   │   └── 62kb.png
	│   ├── index.html
	│   ├── js
	│   │   └── script.js
	│   └── sass
	│       └── style.scss
	└── webpack.config.js
```

所需依赖

```json package.json
  "devDependencies": {
    "autoprefixer": "^7.2.3",
    "css-loader": "^0.28.7",
    "extract-text-webpack-plugin": "^3.0.2",
    "file-loader": "^1.1.5",
    "html-webpack-plugin": "^2.30.1",
    "html-withimg-loader": "^0.1.16",
    "less": "^2.7.3",
    "less-loader": "^4.0.5",
    "node-sass": "^4.7.2",
    "postcss-loader": "^2.0.9",
    "purify-css": "^1.2.5",
    "purifycss-webpack": "^0.7.0",
    "sass-loader": "^6.0.6",
    "scss-loader": "^0.0.1",
    "style-loader": "^0.19.1",
    "uglifyjs-webpack-plugin": "^1.1.4",
    "url-loader": "^0.6.2",
    "webpack": "^3.10.0",
    "webpack-dev-server": "^2.9.7"
  },
```

## 使用 webpack 处理 less 文件

webpack 处理 less 文件是使用 'less-loader';

### 处理 less 步骤

1. 安装依赖

	```shell shell
		cnpm i -D less less-loader
		# 这里需要注意：如果本机没有安装 less, 那么将会在安装 less-loader 的时候提示你安装 less,
	```
1. 配置 `webpack.config.js`

	```js webpack.config.js
		...
		{
			test: /\.less$/,
			use: [{
				loader: 'css-loader'
			}, {
				loader: 'less-loader'
			}]
		}
		...
	```

	如果希望将 less 打包出去

	```js webpack.config.js
		{
			test: /\.less$/,
			use: extractTextPlugin.extract({
				fallback: 'style-loader',
				use: [{
					loader: 'css-loader'
				}, {
					loader: 'less-loader'
				}]
			})
		}
	```
1. 运行

	```shell
		webpack
	```

	个人不是 less 的使用者，所以 less 就到这；

******

## 使用 webpack 处理 scss 文件

webpack 处理 less 文件是使用 'scss-loader';

### 处理 scss 步骤

1. 编写 sass 并在 `entry.js` 中通过 import 引入
1. 安装依赖

	```shell shell
		cnpm i -D node-sass sass-loader
		#这里需要注意：如果本机没有安装 node-sass, 那么将会在安装 sass-loader 的时候提示你安装 sass;
	```
1. 配置 `webpack.config.js`

	```js webpack.config.js
		...
		{
			test: /\.sass$/,
			use: [{
				loader: 'css-loader'
			}, {
				loader: 'sass-loader'
			}]
		}
		...
	```

	如果希望将 sass 打包出去

	```js webpack.config.js
		...
		{
			test: /\.(scss|sass)$/,
			use: extractTextPlugin.extract({
				fallback: 'style-loader',
				use: [{
					loader: 'css-loader'
				}, {
					loader: 'sass-loader'
				}]
			})
		}
		...
	```
1. 运行

	```shell
		webpack
	```

	这里输出的内容很多，就不做摘录，但是观察输出的内容可以为以后的排错提供帮助，不可忽视

	```shell tree
		.
		├── dist
		│   ├── bundle.js
		│   ├── css
		│   │   └── style.css
		│   ├── img
		│   │   └── c841c1357ae08329349b22bdd3dbc886.png
		│   └── index.html
		├── entry.js
		├── package.json
		├── src
		│   ├── css
		│   │   └── style.css
		│   ├── img
		│   │   └── 62kb.png
		│   ├── index.html
		│   ├── js
		│   │   └── script.js
		│   └── sass
		│       └── style.scss
		└── webpack.config.js

	```

******

## 使用 webpack 配合 postcss

首先 postcss 并不是特指某一项功能，而是指 css 后处理器，配合 postcss 插件能完成很多功能

### 使用 webpack&postcss

这里使用 postcss 为 css 样式添加前缀，依赖的插件： `postcss-loader` `autoprefixer`

`postcss-loader` 自不用说；`autoprefier` 是 postcss 为 css 添加前缀的插件

1. 安装依赖

	```shell shell
		cnpm i -D postcss-loader autoprefixer
	```

1. 编写 postcss-loader 配置文件 postcss.config.js

	```js postcss-loader
		module.exports = {
			plugins: [
				require('autoprefixer')
			]
		}
	```

1. 配置 webpack.config.js

	```js webpack.confg.js
		{
			test: /\.css$/,
			use: extractTextPlugin.extract({
				fallback: 'style-loader',
				use: ['css-loader', 'postcss-loader']
			})
		}
	```

	注意：在这里处理的仅仅是 css 文件，如果想对 sass 文件同样有效，需要在处理 scss 中再次添加 `postcss-loader` 处理 

1.	运行

	```js
		webpack
	```

******

## 去除无用的 css

去除 css 中存在，但是在 html 并没有对其响应样式

### webpack 去除无用 css

这里使用的是插件 `purifycss-webpack purify-css`

1. 安装插件

	```shell
		cnpm i -D purifycss-webpack purify-css
	```
1. 配置 webpack.config.js

	```js webpack.config.js
		const glob = require('glob')
		...
		plugins: [
			...
			new purifycss({
				paths: glob.sync(path.join(__dirname, 'src/*.html'))
			})
		]
		// 这里使用 purifycss 处理指定路径下的 html 文件中的链入的文件与 html 的结构进行异步的比较，并将 css 中没有使用到的给过滤掉；
	```
1. 运行

	```shell
		webpack
	```	

******

## TIP

{% blockquote %}

1. 使用 `webpack-dev-server --open` 可以在启用服务的时候直接将其打开

{% endblockquote %}

******

## 参考

链接 | 描述
---|---
[纯金 - Webpack 3.X版本 成神之路](https://www.chungold.com/course/32) | 说的十分高大上，但是也仅仅是一个入门 webpack 教程，适合对 webpack 一知半解的人加强对 webpack 的了解
 | 