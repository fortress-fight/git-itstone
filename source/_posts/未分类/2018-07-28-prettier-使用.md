---
title: prettier-使用
tags:
    - pretty
    - vscode
folder:
    - 待分类
abbrlink: 52f413d7
floder: 工具向
category:
    - 工具向
photos:
    - "http://resources.ffstone.top/image/20180728094603.png"
date: 2018-07-28 09:30:56
---

---

<!-- more -->

![prettier](http://resources.ffstone.top/image/20180728094603.png)

## Prettier 简介

Prettier 是一个固定代码格式化程序，能够支持多种语言：

-   JavaScript
-   JSON
-   CSS/Less/Scss
-   Markdown
-   Vue
-   TS

...

使用 Prettier 的目的是统一代码格式

> Prettier 只打印代码，不会改变代码。

参考：

[prettier](https://prettier.io/)

## 使用 Prettier

### 安装

```bash
    npm i -D -E prettier
    # 或者安装全局
    npm i -g prettier
```

### CLI

-   使用 `--write` 格式代码 prettier 将重写代码

    ```bash
        # prettier [opts] [filename ...]
        prettier --single-quote --trailing-comma es5 --write "{app,__{tests,mocks}__}/**/*.js"
        # 路径采用的是 global 语法
    ```

-   `--debug-check`
    如果你担心 Prettier 会修改代码，导致代码出现问题，可以使用 `--debug-check` 到命令中，这样 prettier 不会重写你的代码，而是在检测到代码正确性可能更改的位置打印错误消息

-   `--find-config-path` 和 `--config`
    指定配置文件

-   `--ignore-path`
    指定要忽略的文件的配置文件，一般是在 `./.prettierignore`

-   `--require-pragma`

    ```js
    /**
     * @prettier
     */
    ```

-   `--list-different`
    `--list-different`（或-l）打印与 Prettier 格式不同的文件的文件名。如果存在差异，则脚本错误输出，这在 CI 方案中很有用。

    ...

## 与 ESLint 集成

### 使用 ESLint 运行 Prettier

```bash
    npm i -D prettier eslint-plugin-prettier
```

.eslintrc.json

```json
{
    "plugins": ["prettier"],
    "rules": {
        "prettier/prettier": "error"
    }
}
```

### 禁用冲突规则

```bash
    npm i -D eslint-config-prettier
```

.eslintrc.json

```json
{
    "extends": ["prettier"]
}
```

### 同时使用

```json
{
    "extends": ["plugin:prettier/recommended"]
}
```

## 忽视代码

有时我们不希望对所有的代码进行格式化，可以通过使用注释的方式来忽视代码

例如：

```js
// prettier-ignore
var a=b;

// prettier-ignore-start
var a = b;
// preitter-ignore-end
```

## 配置文件

由于 prettier 是一个固定的代码风格，能留给我们进行修改的地方并不多；

prettier 的配置文件：

1. `.prettierrc.*`
2. `prettier.config.js`
3. `package.json` 中的 `prettier` 键

配置项：

```json
{
    // 换行宽度，建议 80
    "printWidth": 80,
    // 缩进时的空格数
    "tabWidth": 4,
    // 是否使用制表符
    "useTabs": false,
    // true - 在每个语句的末尾添加分号。
    // false - 仅在可能引入ASI故障的行的开头添加分号。
    "semi": true,
    // 使用单引号
    "singleQuote": true,
    // 尾随逗号 多行时尽可能打印尾随逗号。（例如，单行数组永远不会得到尾随逗号。）
    // "none" - 没有尾随逗号。
    // "es5" - 在ES5中有效的尾随逗号（对象，数组等）
    // "all" - 尽可能使用尾随逗号（包括函数参数）。这需要节点8或变换。
    "trailingComma": "all",
    // 在对象文字中打印括号之间的空格
    // true- 例子：{ foo: bar }。
    // false- 例子：{foo: bar}。
    "bracketSpacing": false,
    // 在唯一箭头函数参数周围包括括号。
    // "avoid" - 尽可能省略parens。例：x => x
    // "always" - 始终包括parens。例：(x) => x
    "arrowParens": "avoid"
    // 解析器：
    // babylon
    // flow
    // typescript 自v1.4.0起
    // postcss 自v1.4.0起
    // json 自v1.5.0起
    // graphql 自v1.5.0起
    // markdown 自v1.8.0起
    // 会根据路径自动识别文件格式
    // "parser": flow

    // 需要编译解释，只有在顶部添加 指定注释的文件才会使用 prettier
    // /**
    // * @prettier
    // */
    // "requirePragma": false
}
```

## prettier -- vscode

安装 VSCode 扩展 -- Prettier - Code formatter

默认情况下，Formatting Toggle 仅将格式化程序重置为 PASTE 和 SAVE 事件。要禁用其中一个或重新启用 TYPE 事件的格式化程序，您必须使用该 `formattingToggle.activateFor` 设置对其进行配置。

VSCode 中控制 prettier 的字段有两种：

1. 使用 prettier
2. 使用 formate

示例：

```js
// 为了使格式化被放回只对SAVE事件：
// 转到您的设置（代码>首选项>设置）。
"formattingToggle.activateFor": ["formatOnSave"]。
// 允许格式化程序为所有事件重新打开：
// 转到您的设置（代码>首选项>设置）。
"formattingToggle.activateFor": ["formatOnPaste", "formatOnSave", "formatOnType"]。
```

## 总结

```bash
    npm i -g prettier
    npm i -g eslint-config-prettier
    npm i -g eslint-plugin-prettier
```

.eslintrc.json

```js
module.exports = {
    root: true,
    parser: "babel-eslint",
    parserOptions: {
        sourceType: "module",
        ecmaVersion: 6
    },
    env: {
        es6: true,
        browser: true,
        node: true
    },
    plugins: ["eslint-plugin-html", "plugin:prettier/recommended"],
    extends: ["standard", "prettier"],
    rules: {
        "prettier/prettier": "error"
    }
};
```
