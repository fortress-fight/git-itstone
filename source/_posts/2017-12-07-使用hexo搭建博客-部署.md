---
title: 使用hexo搭建博客-部署
tags:
  - hexo
  - blog
  - 博客
categories:
  - blog
abbrlink: 28132
date: 2017-12-07 02:34:58
---

在完成页面的搭建以后，我们会希望能够在浏览器上进行预览 

<!-- more -->

## 部署到本地

在部署到线上之前，可以先在本地进行预览；在本地预览之前需要进行一些部署；

### 服务器

Hexo 3.0 把服务器独立成了个别模块，依赖 [hexo-server](https://www.npmjs.com/package/hexo-server)

```cmd
    npm i hexo-server --save
```

安装完成后，运行 `hexo server` 将会返回页面预览地址，打开就能看到页面；

如果想要改变端口可以使用 `-p` 选项指定其他端口； `hexo server -p 5000`

### 静态模式

上述的方式打开的页面，会自动处理文件变动；如果只想看到 `public` 文件夹内的文件，可以使用 `-s`

```cmd
    hexo generate -- 生成静态页面到 public 文件夹内
    hexo server -s
```

### 自定义 IP

服务器默认运行在 `0.0.0.0` 下，你可以覆盖默认的 IP；

```cmd
    hexo server -i 192.168.1.1
```

### 预览草稿文件

在创建文件的时候有一种类型 -- draft (草稿)

如果直接使用 `hexo server` 进行预览将会忽略这类文件，如果希望预览这些文件，可以使用 `hexo server --draft` 来启用服务

******

## 生成文件

使用 Hexo 生成静态文件：`hexo generate`

### 监视文件变动

hexo 能够监视文件变动并立即重新生成静态文件，在生成的时候回对比文件中的 SHA1 checksum，只有变动的文件才会写入

```cmd
    hexo genterate --watch
```

### 完成部署

如果已经关联到了线上可以通过使用下面两个命令，让 Hexo 在生成完毕后自动部署到网站：

```cmd
    hexo generate --deploy
    hexo deploy --generate
```

******

## GitHub page

使用 GitHub Page 配合 hexo，搭建博客会变得特别简单；

### 开启 GitHub page

1. 首先在 GitHub 建立一个仓库
2. 在仓库的设置中开启 GitHub page，这时将会的到一个访问地址

### 部署到 GitHub page

在部署到 GitHub page 之前需要先将本地的 hexo 和你的远程仓库关联起来

1. 修改 `_config.yml` 中的参数, 找到 `deploy` 字段，然后修改如下：

    ```yml
        deploy:
            type: git
            repo: 仓库地址
            branch: [branch]
            message: [message]
    ```
2. 安装 [hexo-deployer-git](https://www.npmjs.com/package/hexo-deployer-git)
    
    这里演示的是上传到 git 仓库，所依赖的插件，如果需要部署到其余地方，可以查看官方文档 [部署](https://hexo.io/zh-cn/docs/deployment.html)

    ```cmd
        cnpm i --save hexo-deployer-git
    ```
3. 执行部署命令

    ```cmd
        hexo deploy
    ```

    由于 Hexo 可以生成静态页面，所以可以将文件夹 `public` 下的文件，复制到你喜欢的地方

    ```yml
        deploy:
        -   type: git
            repo: 仓库地址
            branch: [branch]
            message: [message]
        -   type: heroku
        ...
    ```

    hexo 允许同时设置多个部署方式，在执行 `hexo deploy` 将会按照顺序进行部署；

******

## 使用 GitHub 托管编辑文件

在本地编辑的文件目录，很难进行多端操作；如果能够通过 GitHub 进行托管就更好了，但是目前博客仓库已经作为一个博客页面使用，再建一个仓库存放编辑文件，又有些浪费；

### 托管到 GitHub

托管到博客页所在仓库，就需要进行分支管理；这里我将创建两个分支 

- `master` -- 托管博客页面
- `hexo` -- 托管编辑文件

具体操作：

1. 首先在本地文件中使用 `git init`
2. 本地仓库创建分支 -- hexo
3. 使用 `git add .` `git -m "init hexo"`
4. 关联远程仓库 `git remote add origin 仓库名称`
5. `git push origin hexo` 

### 建立 GitHub README.md

如何保留 GitHub 中的 README.md；

1. `source` 目录下建一个 `README.md` 文件
2. 但是如果仅仅如此，这个 md 文件将会被 rend（编译），这时需要告诉 hexo 这个文件我不想被编译：  
    在根下的 _config.yml 编辑 `skip_render`: 字段，修改为 `skip_render: README.md`

******